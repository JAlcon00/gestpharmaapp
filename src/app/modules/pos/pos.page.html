<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Punto de Venta</ion-title>
    <ion-chip slot="end" color="light" *ngIf="cartItemCount > 0">
      <ion-icon name="cart-outline"></ion-icon>
      <ion-label>{{ cartItemCount }}</ion-label>
    </ion-chip>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar 
      [(ngModel)]="searchQuery"
      (ionInput)="onSearchChange($event)"
      placeholder="Buscar productos..."
      animated="true">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="pos-container">
       <!-- Products List -->
     <div class="products-section">
       <h2 class="section-title">Productos</h2>

       <!-- Loading Skeletons -->
       <div *ngIf="loading" class="products-skeletons">
         <app-skeleton variant="card" *ngFor="let i of [1,2,3,4,5,6,7,8]"></app-skeleton>
       </div>

       <!-- Premium Product Grid -->
       <div class="products-grid" *ngIf="!loading">
         <app-product-card
           *ngFor="let product of products"
           [product]="product"
           [isInCart]="isInCart(product.id)"
           [quantity]="getCartItemQuantity(product.id)"
           (addToCart)="addToCart(product)"
           (increment)="incrementQuantity(product.id)"
           (decrement)="decrementQuantity(product.id)">
         </app-product-card>
       </div>

       <!-- Empty State -->
       <app-empty-state
         *ngIf="!loading && products.length === 0"
         type="products"
         title="¡No hay productos disponibles!"
         description="No se encontraron productos que coincidan con tu búsqueda. Intenta con otros términos o agrega nuevos productos al inventario."
         actionLabel="Ver Todo el Inventario"
         actionIcon="list-outline"
         (actionClick)="clearSearch()">
       </app-empty-state>
    </div>

  </div>

  <!-- Side Cart Component -->
  <app-side-cart
    [isOpen]="cartOpen"
    [cartItems]="cartItems"
    [cartTotal]="cartTotal"
    [cartItemCount]="cartItemCount"
    (close)="closeCart()"
    (incrementItem)="incrementQuantity($event)"
    (decrementItem)="decrementQuantity($event)"
    (removeItem)="removeFromCart($event)"
    (proceedToCheckout)="goToCheckout()">
  </app-side-cart>

  <!-- Floating Cart Button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" *ngIf="cartItems.length > 0">
    <ion-fab-button (click)="openCart()">
      <ion-icon name="cart-outline"></ion-icon>
      <ion-badge color="danger" class="cart-badge">{{ cartItemCount }}</ion-badge>
    </ion-fab-button>
  </ion-fab>

  <!-- Floating Add Client Button -->
  <ion-fab vertical="bottom" horizontal="start" slot="fixed">
    <ion-fab-button color="success" (click)="addNewClient()">
      <ion-icon name="person-add-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
